<meta name='viewport' content='width=device-width, initial-scale=1'/><!DOCTYPE html>

<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4 x 40 B-Day-Bash - Partybeiträge</title>
    <meta name="description" content="Partybeiträge für die 4 x 40 B-Day-Bash Party am 01.-03.08.2025 im Anglerheim Jena">
    <meta name="keywords" content="Birthday Party, Partybeiträge, Geburtstag, Party, Jena">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');

```
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }
    
    body {
        font-family: 'Orbitron', monospace;
        background: linear-gradient(135deg, #1a0033 0%, #2d1b4e 50%, #4a0e4e 100%);
        min-height: 100vh;
        color: #ffffff;
        overflow-x: hidden;
    }
    
    .stars {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: -1;
    }
    
    .star {
        position: absolute;
        width: 2px;
        height: 2px;
        background: #ffffff;
        border-radius: 50%;
        animation: twinkle 2s infinite alternate;
    }
    
    @keyframes twinkle {
        0% { opacity: 0.3; }
        100% { opacity: 1; }
    }
    
    .neon-lines {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: -1;
    }
    
    .neon-line {
        position: absolute;
        height: 2px;
        background: linear-gradient(90deg, transparent, #ff00ff, transparent);
        animation: neon-sweep 4s linear infinite;
    }
    
    @keyframes neon-sweep {
        0% { transform: translateX(-100%); }
        100% { transform: translateX(100vw); }
    }
    
    .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        position: relative;
    }
    
    .header {
        text-align: center;
        margin-bottom: 40px;
        padding: 30px;
        background: rgba(0, 0, 0, 0.3);
        border: 2px solid #ff00ff;
        border-radius: 15px;
        box-shadow: 0 0 30px rgba(255, 0, 255, 0.3);
    }
    
    .title {
        font-size: clamp(1.8rem, 6vw, 3rem);
        font-weight: 900;
        color: #ff00ff;
        text-shadow: 0 0 20px #ff00ff;
        margin-bottom: 10px;
        letter-spacing: 3px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    
    .date {
        font-size: clamp(1rem, 3vw, 1.5rem);
        color: #00ffff;
        text-shadow: 0 0 10px #00ffff;
        margin-bottom: 20px;
        letter-spacing: 2px;
    }
    
    .subtitle {
        font-size: clamp(0.9rem, 2.5vw, 1.2rem);
        color: #ffffff;
        opacity: 0.8;
    }
    
    .progress-bar {
        width: 100%;
        height: 30px;
        background: rgba(0, 0, 0, 0.5);
        border-radius: 15px;
        overflow: hidden;
        margin-bottom: 40px;
        border: 2px solid #00ffff;
    }
    
    .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #ff00ff, #00ffff);
        transition: width 0.3s ease;
        border-radius: 15px;
    }
    
    .progress-text {
        text-align: center;
        margin-top: 10px;
        font-size: 1.1rem;
        color: #00ffff;
    }
    
    .items-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 20px;
        margin-bottom: 40px;
    }
    
    .section-title {
        font-size: clamp(1.5rem, 4vw, 2rem);
        font-weight: 900;
        color: #ff00ff;
        text-shadow: 0 0 15px rgba(255, 0, 255, 0.8);
        text-align: center;
        margin: 40px 0 30px;
        letter-spacing: 2px;
    }
    
    .additional-section {
        margin-top: 50px;
    }
    
    .add-item-card {
        background: rgba(0, 0, 0, 0.2);
        border: 2px dashed #666;
        border-radius: 10px;
        padding: 20px;
        text-align: center;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }
    
    .add-item-card:hover {
        border-color: #ff00ff;
        box-shadow: 0 0 20px rgba(255, 0, 255, 0.1);
    }
    
    .add-item-title {
        font-size: 1.2rem;
        font-weight: 700;
        color: #ff00ff;
        margin-bottom: 15px;
        text-shadow: 0 0 10px rgba(255, 0, 255, 0.5);
    }
    
    .add-item-controls {
        display: flex;
        gap: 10px;
        align-items: center;
        justify-content: center;
        flex-wrap: wrap;
    }
    
    .add-item-input {
        flex: 1;
        min-width: 200px;
        padding: 10px;
        border: 2px solid #333;
        border-radius: 5px;
        background: rgba(0, 0, 0, 0.7);
        color: #ffffff;
        font-family: 'Orbitron', monospace;
        font-size: 1rem;
    }
    
    .add-item-input:focus {
        outline: none;
        border-color: #ff00ff;
        box-shadow: 0 0 10px rgba(255, 0, 255, 0.3);
    }
    
    .btn-add {
        background: linear-gradient(45deg, #ff00ff, #00ffff);
        color: #000;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        font-family: 'Orbitron', monospace;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s ease;
        text-transform: uppercase;
        font-size: 0.9rem;
    }
    
    .btn-add:hover {
        box-shadow: 0 0 15px rgba(255, 0, 255, 0.5);
        transform: translateY(-2px);
    }
    
    .additional-items-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 20px;
        margin-bottom: 20px;
    }
    
    .additional-item-card {
        background: rgba(0, 0, 0, 0.3);
        border: 2px solid #666;
        border-radius: 10px;
        padding: 20px;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }
    
    .additional-item-card:hover {
        border-color: #00ffff;
        box-shadow: 0 0 20px rgba(0, 255, 255, 0.1);
    }
    
    .additional-item-name {
        font-size: 1.2rem;
        font-weight: 700;
        color: #00ffff;
        margin-bottom: 10px;
        text-shadow: 0 0 10px rgba(0, 255, 255, 0.3);
    }
    
    .additional-note {
        font-size: 0.8rem;
        color: #888;
        font-style: italic;
        margin-bottom: 15px;
    }
    
    .item-card {
        background: rgba(0, 0, 0, 0.4);
        border: 2px solid #333;
        border-radius: 10px;
        padding: 20px;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }
    
    .item-card:hover {
        border-color: #ff00ff;
        box-shadow: 0 0 20px rgba(255, 0, 255, 0.2);
    }
    
    .item-card.taken {
        border-color: #00ff00;
        box-shadow: 0 0 20px rgba(0, 255, 0, 0.2);
    }
    
    .item-name {
        font-size: 1.3rem;
        font-weight: 700;
        color: #ffffff;
        margin-bottom: 10px;
        text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
    }
    
    .item-counter {
        font-size: 0.9rem;
        color: #00ffff;
        margin-bottom: 15px;
        text-shadow: 0 0 10px rgba(0, 255, 255, 0.3);
        font-weight: 600;
    }
    
    .persons-list {
        margin-bottom: 15px;
        max-height: 150px;
        overflow-y: auto;
    }
    
    .person-entry {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 12px;
        margin-bottom: 5px;
        background: rgba(0, 255, 0, 0.1);
        border: 1px solid rgba(0, 255, 0, 0.3);
        border-radius: 5px;
        transition: all 0.3s ease;
    }
    
    .person-entry:hover {
        background: rgba(0, 255, 0, 0.2);
        border-color: rgba(0, 255, 0, 0.5);
    }
    
    .person-name {
        color: #00ff00;
        font-weight: 600;
        text-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
    }
    
    .btn-small {
        padding: 4px 8px;
        border: none;
        border-radius: 3px;
        font-family: 'Orbitron', monospace;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 0.8rem;
    }
    
    .btn-small.btn-unregister {
        background: linear-gradient(45deg, #ff4444, #ff6666);
        color: #fff;
    }
    
    .btn-small.btn-unregister:hover {
        background: linear-gradient(45deg, #ff6666, #ff8888);
        transform: scale(1.1);
    }
    
    .complete-message {
        color: #00ff00;
        font-weight: 700;
        font-size: 1.1rem;
        text-align: center;
        text-shadow: 0 0 15px rgba(0, 255, 0, 0.8);
        animation: neon-pulse 2s ease-in-out infinite;
    }
    
    .item-controls {
        display: flex;
        gap: 10px;
        align-items: center;
        flex-wrap: wrap;
    }
    
    .name-input {
        flex: 1;
        padding: 10px;
        border: 2px solid #333;
        border-radius: 5px;
        background: rgba(0, 0, 0, 0.7);
        color: #ffffff;
        font-family: 'Orbitron', monospace;
        font-size: 1rem;
        min-width: 150px;
    }
    
    .name-input:focus {
        outline: none;
        border-color: #ff00ff;
        box-shadow: 0 0 10px rgba(255, 0, 255, 0.3);
    }
    
    .btn {
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        font-family: 'Orbitron', monospace;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s ease;
        text-transform: uppercase;
        font-size: 0.9rem;
    }
    
    .btn-take {
        background: linear-gradient(45deg, #ff00ff, #00ffff);
        color: #000;
    }
    
    .btn-take:hover {
        box-shadow: 0 0 15px rgba(255, 0, 255, 0.5);
        transform: translateY(-2px);
    }
    
    .btn-release {
        background: linear-gradient(45deg, #ff4444, #ff6666);
        color: #fff;
    }
    
    .btn-release:hover {
        box-shadow: 0 0 15px rgba(255, 68, 68, 0.5);
        transform: translateY(-2px);
    }
    
    .btn-unregister {
        background: linear-gradient(45deg, #ffaa00, #ff6600);
        color: #fff;
        margin-left: 10px;
    }
    
    .btn-unregister:hover {
        box-shadow: 0 0 15px rgba(255, 170, 0, 0.5);
        transform: translateY(-2px);
    }
    
    .taken-by {
        color: #00ff00;
        font-weight: 700;
        text-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
        flex: 1;
    }
    
    .taken-controls {
        display: flex;
        gap: 10px;
        align-items: center;
        flex-wrap: wrap;
    }
    
    /* Danke-Effekt */
    .thank-you-effect {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: clamp(1.2rem, 3vw, 2rem);
        font-weight: 900;
        color: #00ffff;
        text-shadow: 0 0 20px #00ffff;
        font-family: 'Orbitron', monospace;
        letter-spacing: 3px;
        opacity: 0;
        z-index: 100;
        pointer-events: none;
        animation: thank-you-animation 4s ease-out forwards;
        text-align: center;
        white-space: nowrap;
        padding: 0 20px;
    }
    
    .thank-you-effect::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(45deg, #00ffff, #ff00ff, #00ffff);
        background-size: 200% 200%;
        animation: hologram-shimmer 0.5s ease-in-out infinite;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        z-index: -1;
    }
    
    .thank-you-effect::after {
        content: '';
        position: absolute;
        top: -10px;
        left: -10px;
        right: -10px;
        bottom: -10px;
        background: radial-gradient(circle, rgba(0, 255, 255, 0.3) 0%, transparent 70%);
        border-radius: 50%;
        animation: pulse-glow 4s ease-out;
        z-index: -2;
    }
    
    .goodbye-effect {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: clamp(1rem, 2.5vw, 1.8rem);
        font-weight: 900;
        color: #ffaa00;
        text-shadow: 0 0 20px #ffaa00;
        font-family: 'Orbitron', monospace;
        letter-spacing: 2px;
        opacity: 0;
        z-index: 100;
        pointer-events: none;
        animation: goodbye-animation 4s ease-out forwards;
        text-align: center;
        white-space: nowrap;
        padding: 0 20px;
    }
    
    .goodbye-effect::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(45deg, #ffaa00, #ff6600, #ffaa00);
        background-size: 200% 200%;
        animation: hologram-shimmer 0.5s ease-in-out infinite;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        z-index: -1;
    }
    
    /* Particle-Effekt */
    .particle {
        position: absolute;
        width: 3px;
        height: 3px;
        background: #00ffff;
        border-radius: 50%;
        pointer-events: none;
        animation: particle-float 4s ease-out forwards;
    }
    
    .particle:nth-child(odd) {
        background: #ff00ff;
        animation-delay: 0.1s;
    }
    
    .particle:nth-child(3n) {
        background: #ffffff;
        animation-delay: 0.2s;
    }
    
    .particle-orange {
        background: #ffaa00;
    }
    
    .particle-orange:nth-child(odd) {
        background: #ff6600;
    }
    
    /* Matrix-Effekt */
    .matrix-effect {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
        pointer-events: none;
        z-index: 99;
    }
    
    .matrix-line {
        position: absolute;
        width: 2px;
        height: 20px;
        background: linear-gradient(to bottom, transparent, #00ffff, transparent);
        animation: matrix-fall 4s linear forwards;
    }
    
    .matrix-line-orange {
        background: linear-gradient(to bottom, transparent, #ffaa00, transparent);
    }
    
    /* Scanline-Effekt */
    .scanline {
        position: absolute;
        width: 100%;
        height: 2px;
        background: linear-gradient(90deg, transparent, #00ffff, transparent);
        top: 50%;
        left: 0;
        animation: scanline-sweep 3s ease-out;
        z-index: 98;
    }
    
    .scanline-orange {
        background: linear-gradient(90deg, transparent, #ffaa00, transparent);
    }
    
    @keyframes thank-you-animation {
        0% {
            opacity: 0;
            transform: translate(-50%, -50%) scale(0.1);
            filter: blur(10px);
        }
        15% {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1.2);
            filter: blur(2px);
        }
        30% {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
            filter: blur(0px);
        }
        70% {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
            filter: blur(0px);
        }
        100% {
            opacity: 0;
            transform: translate(-50%, -50%) scale(0.8);
            filter: blur(5px);
        }
    }
    
    @keyframes goodbye-animation {
        0% {
            opacity: 0;
            transform: translate(-50%, -50%) scale(1.2);
            filter: blur(5px);
        }
        20% {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
            filter: blur(0px);
        }
        60% {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
            filter: blur(0px);
        }
        100% {
            opacity: 0;
            transform: translate(-50%, -50%) scale(0.5);
            filter: blur(8px);
        }
    }
    
    @keyframes hologram-shimmer {
        0% {
            background-position: 0% 50%;
        }
        50% {
            background-position: 100% 50%;
        }
        100% {
            background-position: 0% 50%;
        }
    }
    
    @keyframes pulse-glow {
        0% {
            opacity: 0;
            transform: scale(0.5);
        }
        50% {
            opacity: 0.8;
            transform: scale(1.2);
        }
        100% {
            opacity: 0;
            transform: scale(2);
        }
    }
    
    @keyframes particle-float {
        0% {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
        100% {
            opacity: 0;
            transform: translateY(-50px) scale(0.5);
        }
    }
    
    @keyframes matrix-fall {
        0% {
            top: -20px;
            opacity: 0;
        }
        50% {
            opacity: 1;
        }
        100% {
            top: 100%;
            opacity: 0;
        }
    }
    
    @keyframes scanline-sweep {
        0% {
            transform: translateY(-100px);
            opacity: 0;
        }
        50% {
            opacity: 1;
        }
        100% {
            transform: translateY(100px);
            opacity: 0;
        }
    }
    
    /* Thank You Animation Overlay */
    .thank-you-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.9);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
    }
    
    .thank-you-overlay.show {
        opacity: 1;
        pointer-events: all;
    }
    
    .thank-you-content {
        text-align: center;
        position: relative;
    }
    
    .thank-you-text {
        font-size: 4rem;
        font-weight: 900;
        color: #ff00ff;
        text-shadow: 0 0 30px #ff00ff;
        margin-bottom: 20px;
        animation: glitch 0.5s ease-in-out infinite alternate;
    }
    
    .thank-you-subtext {
        font-size: 1.5rem;
        color: #00ffff;
        text-shadow: 0 0 20px #00ffff;
        animation: neon-pulse 1s ease-in-out infinite;
    }
    
    .retro-grid {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 800px;
        height: 600px;
        background: linear-gradient(
            90deg,
            transparent 49%,
            #ff00ff 50%,
            #ff00ff 51%,
            transparent 52%
        ),
        linear-gradient(
            0deg,
            transparent 49%,
            #ff00ff 50%,
            #ff00ff 51%,
            transparent 52%
        );
        background-size: 40px 40px;
        opacity: 0.3;
        animation: grid-move 2s linear infinite;
        z-index: -1;
    }
    
    .laser-lines {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
        z-index: -1;
    }
    
    .laser-line {
        position: absolute;
        height: 2px;
        background: linear-gradient(90deg, transparent, #00ffff, transparent);
        animation: laser-sweep 1s linear infinite;
        box-shadow: 0 0 10px #00ffff;
    }
    
    @keyframes glitch {
        0% {
            transform: translateX(0);
            text-shadow: 0 0 30px #ff00ff;
        }
        25% {
            transform: translateX(-5px);
            text-shadow: -5px 0 30px #ff00ff, 5px 0 30px #00ffff;
        }
        50% {
            transform: translateX(5px);
            text-shadow: 5px 0 30px #ff00ff, -5px 0 30px #00ffff;
        }
        75% {
            transform: translateX(-2px);
            text-shadow: -2px 0 30px #ff00ff, 2px 0 30px #00ffff;
        }
        100% {
            transform: translateX(0);
            text-shadow: 0 0 30px #ff00ff;
        }
    }
    
    @keyframes neon-pulse {
        0%, 100% {
            text-shadow: 0 0 20px #00ffff;
        }
        50% {
            text-shadow: 0 0 40px #00ffff, 0 0 60px #00ffff;
        }
    }
    
    @keyframes grid-move {
        0% {
            transform: translate(-50%, -50%);
        }
        100% {
            transform: translate(-50%, -70%);
        }
    }
    
    @keyframes laser-sweep {
        0% {
            left: -100%;
            top: 20%;
        }
        100% {
            left: 100%;
            top: 80%;
        }
    }
    
    /* Drive Status */
    .drive-status {
        text-align: center;
        margin-bottom: 20px;
        padding: 15px;
        background: rgba(0, 0, 0, 0.3);
        border-radius: 10px;
        border: 2px solid #333;
        display: none;
        position: relative;
        z-index: 2;
    }
    
    .drive-status.connected {
        border-color: #00ff00;
        box-shadow: 0 0 20px rgba(0, 255, 0, 0.2);
    }
    
    .drive-status.disconnected {
        border-color: #ff4444;
        box-shadow: 0 0 20px rgba(255, 68, 68, 0.2);
    }
    
    .status-text {
        font-weight: 700;
        margin-bottom: 10px;
    }
    
    .connect-btn {
        background: linear-gradient(45deg, #00ff00, #00ffff);
        color: #000;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        font-family: 'Orbitron', monospace;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s ease;
        text-transform: uppercase;
    }
    
    .connect-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 0 15px rgba(0, 255, 0, 0.5);
    }
    
    /* Export Section */
    .export-section {
        text-align: center;
        margin-bottom: 30px;
        display: none;
        position: relative;
        z-index: 2;
    }
    
    .export-btn {
        background: linear-gradient(45deg, #00ffff, #ff00ff);
        color: #000;
        padding: 15px 30px;
        border: none;
        border-radius: 10px;
        font-family: 'Orbitron', monospace;
        font-weight: 700;
        font-size: 1.1rem;
        cursor: pointer;
        transition: all 0.3s ease;
        text-transform: uppercase;
        margin: 0 10px;
        box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
    }
    
    .export-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 0 30px rgba(0, 255, 255, 0.5);
    }
    
    .export-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }
    
    /* Admin Login Section */
    .admin-section {
        text-align: center;
        margin-top: 40px;
        padding: 20px;
        background: rgba(0, 0, 0, 0.3);
        border-radius: 15px;
        border: 2px solid #333;
        position: relative;
        overflow: hidden;
    }
    
    .admin-login {
        display: block;
        position: relative;
        z-index: 2;
    }
    
    .admin-controls {
        display: none;
        position: relative;
        z-index: 2;
    }
    
    .admin-login-bg {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(45deg, transparent, rgba(255, 0, 255, 0.1), transparent);
        animation: admin-bg-pulse 3s ease-in-out infinite;
        z-index: 1;
    }
    
    .admin-title {
        color: #ff00ff;
        font-size: clamp(1.3rem, 3vw, 1.8rem);
        font-weight: 900;
        margin-bottom: 30px;
        text-shadow: 0 0 20px rgba(255, 0, 255, 0.8);
        animation: admin-title-glow 2s ease-in-out infinite alternate;
        letter-spacing: 2px;
    }
    
    .admin-input-container {
        position: relative;
        display: inline-block;
        margin-bottom: 20px;
    }
    
    .admin-input {
        padding: 15px 20px;
        border: 2px solid #333;
        border-radius: 10px;
        background: rgba(0, 0, 0, 0.8);
        color: #ffffff;
        font-family: 'Orbitron', monospace;
        font-size: 1.1rem;
        width: 300px;
        text-align: center;
        transition: all 0.3s ease;
        position: relative;
        z-index: 2;
    }
    
    .admin-input::placeholder {
        color: rgba(255, 255, 255, 0.5);
        font-style: italic;
    }
    
    .admin-input:focus {
        outline: none;
        border-color: #ff00ff;
        box-shadow: 0 0 25px rgba(255, 0, 255, 0.5);
        background: rgba(0, 0, 0, 0.9);
        transform: scale(1.05);
    }
    
    .admin-input-glow {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        border: 2px solid transparent;
        border-radius: 10px;
        background: linear-gradient(45deg, #ff00ff, #00ffff, #ff00ff);
        background-size: 200% 200%;
        animation: admin-input-border 3s ease-in-out infinite;
        z-index: 1;
        opacity: 0;
        transition: opacity 0.3s ease;
    }
    
    .admin-input:focus + .admin-input-glow {
        opacity: 1;
    }
    
    .admin-btn {
        background: linear-gradient(45deg, #ff00ff, #00ffff);
        color: #000;
        padding: 15px 35px;
        border: none;
        border-radius: 10px;
        font-family: 'Orbitron', monospace;
        font-weight: 900;
        cursor: pointer;
        transition: all 0.3s ease;
        text-transform: uppercase;
        font-size: 1.1rem;
        letter-spacing: 1px;
        box-shadow: 0 0 20px rgba(255, 0, 255, 0.3);
        position: relative;
        overflow: hidden;
    }
    
    .admin-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
        transition: left 0.5s ease;
    }
    
    .admin-btn:hover::before {
        left: 100%;
    }
    
    .admin-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 0 35px rgba(255, 0, 255, 0.7);
        background: linear-gradient(45deg, #00ffff, #ff00ff);
    }
    
    .admin-panel {
        margin-top: 20px;
        padding: 25px;
        background: rgba(0, 0, 0, 0.4);
        border-radius: 15px;
        border: 2px solid #00ff00;
        box-shadow: 0 0 30px rgba(0, 255, 0, 0.3);
        position: relative;
        overflow: hidden;
    }
    
    .admin-panel::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(45deg, transparent, rgba(0, 255, 0, 0.05), transparent);
        animation: admin-panel-pulse 4s ease-in-out infinite;
    }
    
    .admin-panel h3 {
        color: #00ff00;
        margin-bottom: 20px;
        text-shadow: 0 0 15px rgba(0, 255, 0, 0.8);
        font-size: 1.5rem;
        font-weight: 900;
        letter-spacing: 1px;
        position: relative;
        z-index: 2;
    }
    
    .logout-btn {
        background: linear-gradient(45deg, #ff4444, #ff6666);
        color: #fff;
        padding: 10px 20px;
        border: none;
        border-radius: 8px;
        font-family: 'Orbitron', monospace;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s ease;
        text-transform: uppercase;
        float: right;
        box-shadow: 0 0 15px rgba(255, 68, 68, 0.3);
        position: relative;
        z-index: 2;
    }
    
    .logout-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 0 25px rgba(255, 68, 68, 0.6);
    }
    
    .footer {
        text-align: center;
        margin-top: 40px;
        padding: 20px;
        background: rgba(0, 0, 0, 0.3);
        border-radius: 10px;
        border: 2px solid #333;
    }
    
    .footer h3 {
        color: #ff00ff;
        margin-bottom: 10px;
        text-shadow: 0 0 10px rgba(255, 0, 255, 0.5);
    }
    
    @keyframes admin-bg-pulse {
        0%, 100% { opacity: 0.3; }
        50% { opacity: 0.7; }
    }
    
    @keyframes admin-title-glow {
        0% { 
            text-shadow: 0 0 20px rgba(255, 0, 255, 0.8);
        }
        100% { 
            text-shadow: 0 0 30px rgba(255, 0, 255, 1), 0 0 40px rgba(0, 255, 255, 0.5);
        }
    }
    
    @keyframes admin-input-border {
        0% { 
            background-position: 0% 50%;
        }
        50% { 
            background-position: 100% 50%;
        }
        100% { 
            background-position: 0% 50%;
        }
    }
    
    @keyframes admin-panel-pulse {
        0%, 100% { opacity: 0.1; }
        50% { opacity: 0.3; }
    }
    
    @media (max-width: 768px) {
        .title {
            font-size: clamp(1.5rem, 5vw, 2rem);
            letter-spacing: 1px;
        }
        
        .section-title {
            font-size: clamp(1.2rem, 3.5vw, 1.5rem);
            margin: 30px 0 20px;
        }
        
        .items-grid {
            grid-template-columns: 1fr;
        }
        
        .additional-items-grid {
            grid-template-columns: 1fr;
        }
        
        .item-controls {
            flex-direction: column;
            gap: 10px;
        }
        
        .add-item-controls {
            flex-direction: column;
            gap: 10px;
        }
        
        .add-item-input {
            min-width: unset;
            width: 100%;
        }
        
        .taken-controls {
            flex-direction: column;
            gap: 10px;
            align-items: stretch;
        }
        
        .name-input {
            width: 100%;
        }
        
        .person-entry {
            padding: 6px 10px;
        }
        
        .persons-list {
            max-height: 120px;
        }
        
        .thank-you-text {
            font-size: 2.5rem;
        }
        
        .export-btn {
            display: block;
            margin: 10px auto;
            width: 80%;
        }
        
        .admin-input {
            width: 100%;
            margin-bottom: 20px;
            max-width: 300px;
        }
        
        .admin-input-container {
            width: 100%;
            max-width: 300px;
            margin: 0 auto 20px;
        }
        
        .admin-btn {
            width: 100%;
            max-width: 300px;
        }
        
        .admin-title {
            font-size: clamp(1.2rem, 2.5vw, 1.5rem);
        }
        
        .thank-you-effect {
            font-size: clamp(1rem, 2.5vw, 1.5rem);
            letter-spacing: 1px;
        }
        
        .goodbye-effect {
            font-size: clamp(0.9rem, 2vw, 1.3rem);
            letter-spacing: 1px;
        }
        
        .particle {
            width: 2px;
            height: 2px;
        }
        
        .matrix-line {
            width: 1px;
            height: 15px;
        }
    }
    
    @media (max-width: 480px) {
        .title {
            font-size: clamp(1.2rem, 4.5vw, 1.5rem);
            letter-spacing: 0px;
        }
        
        .date {
            font-size: clamp(0.8rem, 2.5vw, 1rem);
        }
        
        .subtitle {
            font-size: clamp(0.7rem, 2vw, 0.9rem);
        }
        
        .section-title {
            font-size: clamp(1rem, 3vw, 1.2rem);
            margin: 25px 0 15px;
        }
        
        .container {
            padding: 15px;
        }
        
        .header {
            padding: 20px;
        }
        
        .admin-section {
            padding: 15px;
        }
        
        .admin-panel {
            padding: 15px;
        }
        
        .admin-title {
            font-size: clamp(1rem, 2vw, 1.3rem);
            margin-bottom: 25px;
        }
        
        .admin-input {
            width: 100%;
            max-width: 280px;
            font-size: 1rem;
            padding: 12px 15px;
        }
        
        .admin-btn {
            width: 100%;
            max-width: 280px;
            padding: 12px 25px;
            font-size: 1rem;
        }
        
        .logout-btn {
            float: none;
            display: block;
            margin: 0 auto 15px;
            width: 100%;
            max-width: 200px;
        }
        
        .person-entry {
            padding: 5px 8px;
            font-size: 0.9rem;
        }
        
        .persons-list {
            max-height: 100px;
        }
        
        .add-item-card {
            padding: 15px;
        }
        
        .additional-item-card {
            padding: 15px;
        }
        
        .thank-you-effect {
            font-size: clamp(0.8rem, 2vw, 1.2rem);
            letter-spacing: 0px;
        }
        
        .goodbye-effect {
            font-size: clamp(0.7rem, 1.5vw, 1rem);
            letter-spacing: 0px;
        }
        
        .particle {
            width: 1.5px;
            height: 1.5px;
        }
        
        .matrix-line {
            width: 1px;
            height: 12px;
        }
    }
</style>
```

</head>
<body>
    <div class="stars"></div>
    <div class="neon-lines"></div>

```
<div class="container">
    <div class="header">
        <h1 class="title">4 x 40 B-DAY-BASH</h1>
        <div class="date">01. - 03.08.2025</div>
        <div class="subtitle">Partybeiträge • Anglerheim Jena</div>
    </div>
    
    <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
    </div>
    <div class="progress-text" id="progressText">0 Beiträge</div>
    
    <div class="section-title">🎯 Benötigte Partybeiträge</div>
    
    <div class="items-grid" id="itemsGrid">
        <!-- Items werden hier dynamisch eingefügt -->
    </div>
    
    <div class="additional-section">
        <div class="section-title">➕ Weitere Partybeiträge</div>
        
        <div class="additional-items-grid" id="additionalItemsGrid">
            <!-- Zusätzliche Items werden hier dynamisch eingefügt -->
        </div>
        
        <div class="add-item-card">
            <div class="add-item-title">Neuen Partybeitrag vorschlagen</div>
            <div class="additional-note">Hier kannst du weitere Dinge eintragen, die du zur Party beitragen möchtest</div>
            <div class="add-item-controls">
                <input type="text" class="add-item-input" id="newItemInput" placeholder="z.B. Chips, Getränke, Deko...">
                <button class="btn btn-add" onclick="addNewItem()">Hinzufügen</button>
            </div>
        </div>
    </div>
    
    <!-- Thank You Animation Overlay -->
    <div class="thank-you-overlay" id="thankYouOverlay">
        <div class="thank-you-content">
            <div class="retro-grid"></div>
            <div class="laser-lines">
                <div class="laser-line" style="width: 300px; animation-delay: 0s;"></div>
                <div class="laser-line" style="width: 400px; animation-delay: 0.3s;"></div>
                <div class="laser-line" style="width: 250px; animation-delay: 0.6s;"></div>
            </div>
            <div class="thank-you-text">DANKE!</div>
            <div class="thank-you-subtext">Vielen Dank für Ihre Anmeldung!</div>
        </div>
    </div>
    
    <!-- Admin Section -->
    <div class="admin-section">
        <div class="admin-login-bg"></div>
        <div class="admin-login" id="adminLogin">
            <div class="admin-title">🔐 ADMIN ACCESS</div>
            <div class="admin-input-container">
                <input type="password" class="admin-input" id="adminPassword" placeholder="Enter Password">
                <div class="admin-input-glow"></div>
            </div>
            <br>
            <button class="admin-btn" onclick="adminLogin()">
                <span>Initialize</span>
            </button>
        </div>
        
        <div class="admin-controls" id="adminControls">
            <button class="logout-btn" onclick="adminLogout()">Logout</button>
            <div class="admin-panel">
                <h3>⚙️ SYSTEM CONTROL</h3>
                
                <div class="drive-status" id="driveStatus">
                    <div class="status-text">Google Drive Status: <span id="statusText">Nicht verbunden</span></div>
                    <button class="connect-btn" id="connectBtn" onclick="connectToGoogleDrive()">Mit Google Drive verbinden</button>
                </div>
                
                <div class="export-section" id="exportSection">
                    <button class="export-btn" onclick="exportToCSV()">📊 CSV Export</button>
                    <button class="export-btn" onclick="exportToExcel()">📈 Excel Export</button>
                    <button class="export-btn" id="syncBtn" onclick="syncToGoogleDrive()" disabled>☁️ Google Drive Sync</button>
                    <button class="export-btn" onclick="clearAllData()" style="background: linear-gradient(45deg, #ff4444, #ff6666);">🗑️ Alle Daten löschen</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="footer">
        <h3>RESTRICTED</h3>
        <p>Under 18 requires accompanying parent or adult guardian</p>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://apis.google.com/js/api.js"></script>
<script>
    const items = [
        "Nudelsalat",
        "Kartoffelsalat", 
        "Kräuterbutter",
        "Nutella, Erdnussbutter",
        "Kuchen",
        "Marmelade, Honig",
        "Aufschnitt (Wurst, Käse)",
        "Aufstriche (herzhaft)"
    ];
    
    // Definiere die benötigten Mengen für 100% Fortschritt
    const requiredAmounts = {
        "Nudelsalat": 3,
        "Kartoffelsalat": 3,
        "Kräuterbutter": 2,
        "Kuchen": 6,
        "Nutella, Erdnussbutter": 1,
        "Marmelade, Honig": 1,
        "Aufschnitt (Wurst, Käse)": 1,
        "Aufstriche (herzhaft)": 1
    };
    
    // Randomisierte Danke-Texte
    const thankYouMessages = [
        "🙏 Daaaaaankööö! 🙏",
        "💕 Du bist die/der Geilste! 💕",
        "💣 Hammerfettbombekrass! 💣",
        "🥰 Echt?! Thnx!!! 🥰",
        "🛟 Du bist die Rettung 🛟",
        "❤️ Ich hasse alle: Außer DICH! ❤️",
        "❤️‍🔥 Wir lieben Dich! ❤️‍🔥"
    ];
    
    let itemStates = {};
    let additionalItems = {}; // Für weitere Partybeiträge
    let isGoogleDriveConnected = false;
    let googleDriveFileId = null;
    let isAdminLoggedIn = false;
    
    // Google Drive API Konfiguration
    const CLIENT_ID = 'YOUR_CLIENT_ID'; // Hier müssen Sie Ihre Client-ID eintragen
    const API_KEY = 'YOUR_API_KEY'; // Hier müssen Sie Ihren API-Key eintragen
    const DISCOVERY_DOC = 'https://www.googleapis.com/discovery/v1/apis/drive/v3/rest';
    const SCOPES = 'https://www.googleapis.com/auth/drive.file';
    
    // Admin Login
    function adminLogin() {
        const password = document.getElementById('adminPassword').value;
        
        if (password === 'arvid11') {
            isAdminLoggedIn = true;
            document.getElementById('adminLogin').style.display = 'none';
            document.getElementById('adminControls').style.display = 'block';
            document.getElementById('driveStatus').style.display = 'block';
            document.getElementById('exportSection').style.display = 'block';
            updateDriveStatus();
            
            sessionStorage.setItem('admin-logged-in', 'true');
        } else {
            alert('Falsches Passwort!');
            document.getElementById('adminPassword').value = '';
        }
    }
    
    // Admin Logout
    function adminLogout() {
        isAdminLoggedIn = false;
        document.getElementById('adminLogin').style.display = 'block';
        document.getElementById('adminControls').style.display = 'none';
        document.getElementById('driveStatus').style.display = 'none';
        document.getElementById('exportSection').style.display = 'none';
        document.getElementById('adminPassword').value = '';
        
        sessionStorage.removeItem('admin-logged-in');
    }
    
    // Prüfe Admin-Status beim Laden
    function checkAdminStatus() {
        const adminStatus = sessionStorage.getItem('admin-logged-in');
        if (adminStatus === 'true') {
            isAdminLoggedIn = true;
            document.getElementById('adminLogin').style.display = 'none';
            document.getElementById('adminControls').style.display = 'block';
            document.getElementById('driveStatus').style.display = 'block';
            document.getElementById('exportSection').style.display = 'block';
            updateDriveStatus();
        }
    }
    
    // Lade gespeicherte Daten
    function loadData() {
        // Versuche neue Schlüssel zu laden, falls nicht vorhanden, lade alte
        const saved = localStorage.getItem('birthday-party-contributions') || localStorage.getItem('birthday-party-items');
        if (saved) {
            const loadedData = JSON.parse(saved);
            // Konvertiere alte Datenstruktur zu neuer Array-Struktur
            items.forEach(item => {
                if (loadedData[item]) {
                    if (Array.isArray(loadedData[item])) {
                        itemStates[item] = loadedData[item];
                    } else if (loadedData[item].taken && loadedData[item].person) {
                        // Konvertiere altes Format zu neuem Array-Format
                        itemStates[item] = [{
                            person: loadedData[item].person,
                            timestamp: loadedData[item].timestamp || new Date().toLocaleString('de-DE')
                        }];
                    } else {
                        itemStates[item] = [];
                    }
                } else {
                    itemStates[item] = [];
                }
            });
        } else {
            // Initialisiere leere Arrays für alle Items
            items.forEach(item => {
                itemStates[item] = [];
            });
        }
        
        // Lade zusätzliche Items
        const savedAdditional = localStorage.getItem('birthday-party-additional-contributions') || localStorage.getItem('birthday-party-additional-items');
        if (savedAdditional) {
            additionalItems = JSON.parse(savedAdditional);
        }
        
        const driveFileId = localStorage.getItem('google-drive-file-id');
        if (driveFileId) {
            googleDriveFileId = driveFileId;
        }
    }
    
    // Speichere Daten
    function saveData() {
        localStorage.setItem('birthday-party-contributions', JSON.stringify(itemStates));
        localStorage.setItem('birthday-party-additional-contributions', JSON.stringify(additionalItems));
    }
    
    // Google Drive Initialisierung
    async function initializeGoogleDrive() {
        try {
            await gapi.load('auth2', initAuth);
            await gapi.load('client', initClient);
        } catch (error) {
            console.error('Google Drive Initialisierung fehlgeschlagen:', error);
        }
    }
    
    async function initAuth() {
        try {
            await gapi.auth2.init({
                client_id: CLIENT_ID,
            });
        } catch (error) {
            console.error('Auth-Initialisierung fehlgeschlagen:', error);
        }
    }
    
    async function initClient() {
        try {
            await gapi.client.init({
                apiKey: API_KEY,
                discoveryDocs: [DISCOVERY_DOC],
            });
        } catch (error) {
            console.error('Client-Initialisierung fehlgeschlagen:', error);
        }
    }
    
    // Mit Google Drive verbinden
    async function connectToGoogleDrive() {
        if (!isAdminLoggedIn) {
            alert('Zugriff verweigert!');
            return;
        }
        
        try {
            const authInstance = gapi.auth2.getAuthInstance();
            await authInstance.signIn();
            
            isGoogleDriveConnected = true;
            updateDriveStatus();
            
            await createOrFindSpreadsheet();
            await syncToGoogleDrive();
            
        } catch (error) {
            console.error('Google Drive Verbindung fehlgeschlagen:', error);
            alert('Fehler beim Verbinden mit Google Drive. Bitte versuchen Sie es erneut.');
        }
    }
    
    // Erstelle oder finde die Tabelle
    async function createOrFindSpreadsheet() {
        try {
            const data = createExcelData();
            const csvContent = convertToCSV(data);
            
            const metadata = {
                'name': 'Birthday-Party-Partybeitraege.csv',
                'parents': ['appDataFolder']
            };
            
            const response = await gapi.client.request({
                'path': 'https://www.googleapis.com/upload/drive/v3/files',
                'method': 'POST',
                'params': {
                    'uploadType': 'multipart'
                },
                'headers': {
                    'Content-Type': 'multipart/related; boundary="foo_bar_baz"'
                },
                'body': [
                    '--foo_bar_baz',
                    'Content-Type: application/json',
                    '',
                    JSON.stringify(metadata),
                    '--foo_bar_baz',
                    'Content-Type: text/csv',
                    '',
                    csvContent,
                    '--foo_bar_baz--'
                ].join('\r\n')
            });
            
            googleDriveFileId = response.result.id;
            localStorage.setItem('google-drive-file-id', googleDriveFileId);
            
        } catch (error) {
            console.error('Fehler beim Erstellen der Tabelle:', error);
        }
    }
    
    // Erstelle Excel-Daten
    function createExcelData() {
        const data = [
            ['4 x 40 B-Day-Bash - Partybeiträge'],
            ['Datum: 01. - 03.08.2025'],
            ['Ort: Anglerheim Jena'],
            ['Letzte Aktualisierung: ' + new Date().toLocaleString('de-DE')],
            [''],
            ['=== BENÖTIGTE PARTYBEITRÄGE ==='],
            ['Item', 'Benötigt', 'Eingetragen', 'Person', 'Timestamp']
        ];
        
        // Normale Items
        items.forEach(item => {
            const registrations = itemStates[item] || [];
            const requiredCount = requiredAmounts[item] || 1;
            const currentCount = registrations.length;
            
            if (registrations.length === 0) {
                data.push([item, requiredCount, 0, '', '']);
            } else {
                registrations.forEach((reg, index) => {
                    data.push([
                        index === 0 ? item : '',
                        index === 0 ? requiredCount : '',
                        index === 0 ? currentCount : '',
                        reg.person,
                        reg.timestamp
                    ]);
                });
            }
        });
        
        // Zusätzliche Items
        const additionalItemsKeys = Object.keys(additionalItems);
        if (additionalItemsKeys.length > 0) {
            data.push(['']);
            data.push(['=== WEITERE PARTYBEITRÄGE ===']);
            data.push(['Item', 'Typ', 'Eingetragen', 'Person', 'Timestamp']);
            
            additionalItemsKeys.forEach(item => {
                const registrations = additionalItems[item] || [];
                const currentCount = registrations.length;
                
                if (registrations.length === 0) {
                    data.push([item, 'Zusätzlich', 0, '', '']);
                } else {
                    registrations.forEach((reg, index) => {
                        data.push([
                            index === 0 ? item : '',
                            index === 0 ? 'Zusätzlich' : '',
                            index === 0 ? currentCount : '',
                            reg.person,
                            reg.timestamp
                        ]);
                    });
                }
            });
        }
        
        return data;
    }
    
    // Konvertiere zu CSV
    function convertToCSV(data) {
        return data.map(row => 
            row.map(cell => `"${cell}"`).join(',')
        ).join('\n');
    }
    
    // Synchronisiere mit Google Drive
    async function syncToGoogleDrive() {
        if (!isAdminLoggedIn) {
            alert('Zugriff verweigert!');
            return;
        }
        
        if (!isGoogleDriveConnected || !googleDriveFileId) {
            alert('Bitte verbinden Sie sich zuerst mit Google Drive');
            return;
        }
        
        try {
            const data = createExcelData();
            const csvContent = convertToCSV(data);
            
            await gapi.client.request({
                'path': `https://www.googleapis.com/upload/drive/v3/files/${googleDriveFileId}`,
                'method': 'PATCH',
                'params': {
                    'uploadType': 'media'
                },
                'headers': {
                    'Content-Type': 'text/csv'
                },
                'body': csvContent
            });
            
            alert('Daten erfolgreich mit Google Drive synchronisiert!');
            
        } catch (error) {
            console.error('Synchronisation fehlgeschlagen:', error);
            alert('Fehler bei der Synchronisation. Bitte versuchen Sie es erneut.');
        }
    }
    
    // Status-Anzeige aktualisieren
    function updateDriveStatus() {
        if (!isAdminLoggedIn) return;
        
        const statusElement = document.getElementById('driveStatus');
        const statusText = document.getElementById('statusText');
        const connectBtn = document.getElementById('connectBtn');
        const syncBtn = document.getElementById('syncBtn');
        
        if (isGoogleDriveConnected) {
            statusElement.className = 'drive-status connected';
            statusText.textContent = 'Verbunden ✓';
            connectBtn.style.display = 'none';
            syncBtn.disabled = false;
        } else {
            statusElement.className = 'drive-status disconnected';
            statusText.textContent = 'Nicht verbunden';
            connectBtn.style.display = 'inline-block';
            syncBtn.disabled = true;
        }
    }
    
    // Zeige Danke-Effekt direkt in der Karte
    function showThankYouEffect(cardElement) {
        // Wähle eine zufällige Nachricht
        const randomMessage = thankYouMessages[Math.floor(Math.random() * thankYouMessages.length)];
        
        const thankYouText = document.createElement('div');
        thankYouText.className = 'thank-you-effect';
        thankYouText.textContent = randomMessage;
        
        const matrixContainer = document.createElement('div');
        matrixContainer.className = 'matrix-effect';
        
        for (let i = 0; i < 8; i++) {
            const matrixLine = document.createElement('div');
            matrixLine.className = 'matrix-line';
            matrixLine.style.left = Math.random() * 100 + '%';
            matrixLine.style.animationDelay = Math.random() * 0.5 + 's';
            matrixContainer.appendChild(matrixLine);
        }
        
        const scanline = document.createElement('div');
        scanline.className = 'scanline';
        
        const particles = [];
        for (let i = 0; i < 12; i++) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.style.left = Math.random() * 100 + '%';
            particle.style.top = Math.random() * 100 + '%';
            particle.style.animationDelay = Math.random() * 0.3 + 's';
            particles.push(particle);
        }
        
        cardElement.appendChild(matrixContainer);
        cardElement.appendChild(scanline);
        particles.forEach(particle => cardElement.appendChild(particle));
        cardElement.appendChild(thankYouText);
        
        cardElement.style.boxShadow = '0 0 40px rgba(0, 255, 255, 0.6)';
        cardElement.style.borderColor = '#00ffff';
        cardElement.style.transform = 'scale(1.02)';
        
        setTimeout(() => {
            if (thankYouText.parentNode) thankYouText.parentNode.removeChild(thankYouText);
            if (matrixContainer.parentNode) matrixContainer.parentNode.removeChild(matrixContainer);
            if (scanline.parentNode) scanline.parentNode.removeChild(scanline);
            particles.forEach(particle => {
                if (particle.parentNode) particle.parentNode.removeChild(particle);
            });
            
            cardElement.style.boxShadow = '';
            cardElement.style.borderColor = '';
            cardElement.style.transform = '';
        }, 4000); // Verlängert auf 4 Sekunden
    }
    
    // Zeige Tschüss-Effekt
    function showGoodbyeEffect(cardElement) {
        const goodbyeText = document.createElement('div');
        goodbyeText.className = 'goodbye-effect';
        goodbyeText.textContent = 'TSCHÜSS!';
        
        const matrixContainer = document.createElement('div');
        matrixContainer.className = 'matrix-effect';
        
        for (let i = 0; i < 6; i++) {
            const matrixLine = document.createElement('div');
            matrixLine.className = 'matrix-line matrix-line-orange';
            matrixLine.style.left = Math.random() * 100 + '%';
            matrixLine.style.animationDelay = Math.random() * 0.5 + 's';
            matrixContainer.appendChild(matrixLine);
        }
        
        const scanline = document.createElement('div');
        scanline.className = 'scanline scanline-orange';
        
        const particles = [];
        for (let i = 0; i < 8; i++) {
            const particle = document.createElement('div');
            particle.className = 'particle particle-orange';
            particle.style.left = Math.random() * 100 + '%';
            particle.style.top = Math.random() * 100 + '%';
            particle.style.animationDelay = Math.random() * 0.3 + 's';
            particles.push(particle);
        }
        
        cardElement.appendChild(matrixContainer);
        cardElement.appendChild(scanline);
        particles.forEach(particle => cardElement.appendChild(particle));
        cardElement.appendChild(goodbyeText);
        
        cardElement.style.boxShadow = '0 0 40px rgba(255, 170, 0, 0.6)';
        cardElement.style.borderColor = '#ffaa00';
        cardElement.style.transform = 'scale(1.02)';
        
        setTimeout(() => {
            if (goodbyeText.parentNode) goodbyeText.parentNode.removeChild(goodbyeText);
            if (matrixContainer.parentNode) matrixContainer.parentNode.removeChild(matrixContainer);
            if (scanline.parentNode) scanline.parentNode.removeChild(scanline);
            particles.forEach(particle => {
                if (particle.parentNode) particle.parentNode.removeChild(particle);
            });
            
            cardElement.style.boxShadow = '';
            cardElement.style.borderColor = '';
            cardElement.style.transform = '';
        }, 4000); // Verlängert auf 4 Sekunden
    }
    
    // Erstelle Sterne
    function createStars() {
        const starsContainer = document.querySelector('.stars');
        for (let i = 0; i < 100; i++) {
            const star = document.createElement('div');
            star.className = 'star';
            star.style.left = Math.random() * 100 + '%';
            star.style.top = Math.random() * 100 + '%';
            star.style.animationDelay = Math.random() * 2 + 's';
            starsContainer.appendChild(star);
        }
    }
    
    // Erstelle Neon-Linien
    function createNeonLines() {
        const linesContainer = document.querySelector('.neon-lines');
        for (let i = 0; i < 3; i++) {
            const line = document.createElement('div');
            line.className = 'neon-line';
            line.style.top = Math.random() * 100 + '%';
            line.style.width = '200px';
            line.style.animationDelay = Math.random() * 4 + 's';
            linesContainer.appendChild(line);
        }
    }
    
    // Aktualisiere Fortschritt
    function updateProgress() {
        let totalRegistered = 0;
        let totalRequired = 0;
        
        items.forEach(item => {
            const registeredCount = itemStates[item] ? itemStates[item].length : 0;
            const requiredCount = requiredAmounts[item] || 1;
            
            totalRegistered += registeredCount;
            totalRequired += requiredCount;
        });
        
        const percentage = totalRequired > 0 ? (totalRegistered / totalRequired) * 100 : 0;
        
        document.getElementById('progressFill').style.width = Math.min(percentage, 100) + '%';
        
        // Korrekte Singular/Plural-Form für "Beitrag"/"Beiträge"
        const beitragText = totalRegistered === 1 ? 'Beitrag' : 'Beiträge';
        document.getElementById('progressText').textContent = `${totalRegistered} ${beitragText} (${Math.round(percentage)}%)`;
    }
    
    // Erstelle Item-Karten
    function createItemCards() {
        const grid = document.getElementById('itemsGrid');
        grid.innerHTML = '';
        
        items.forEach((item, index) => {
            const registrations = itemStates[item] || [];
            const requiredCount = requiredAmounts[item] || 1;
            const currentCount = registrations.length;
            const isComplete = currentCount >= requiredCount;
            
            const card = document.createElement('div');
            card.className = `item-card ${isComplete ? 'taken' : ''}`;
            card.id = `card-${index}`;
            
            // Erstelle Personenliste
            let personsList = '';
            if (registrations.length > 0) {
                personsList = registrations.map((reg, regIndex) => 
                    `<div class="person-entry">
                        <span class="person-name">${reg.person}</span>
                        <button class="btn-small btn-unregister" onclick="unregisterPerson('${item}', '${reg.person}', ${index})">×</button>
                    </div>`
                ).join('');
            }
            
            card.innerHTML = `
                <div class="item-name">${item}</div>
                <div class="item-counter">${currentCount}/${requiredCount} ${currentCount === 1 ? 'Person' : 'Personen'}</div>
                ${personsList ? `<div class="persons-list">${personsList}</div>` : ''}
                <div class="item-controls">
                    ${isComplete ? 
                        `<div class="complete-message">✓ Vollständig!</div>` :
                        `<input type="text" class="name-input" placeholder="Dein Name" id="input-${index}">
                         <button class="btn btn-take" onclick="addPerson('${item}', ${index})">Eintragen</button>`
                    }
                </div>
            `;
            
            grid.appendChild(card);
        });
    }
    
    // Erstelle zusätzliche Item-Karten
    function createAdditionalItemCards() {
        const grid = document.getElementById('additionalItemsGrid');
        grid.innerHTML = '';
        
        Object.keys(additionalItems).forEach((item, index) => {
            const registrations = additionalItems[item] || [];
            const currentCount = registrations.length;
            
            const card = document.createElement('div');
            card.className = 'additional-item-card';
            card.id = `additional-card-${index}`;
            
            // Erstelle Personenliste
            let personsList = '';
            if (registrations.length > 0) {
                personsList = registrations.map((reg, regIndex) => 
                    `<div class="person-entry">
                        <span class="person-name">${reg.person}</span>
                        <button class="btn-small btn-unregister" onclick="unregisterAdditionalPerson('${item}', '${reg.person}', ${index})">×</button>
                    </div>`
                ).join('');
            }
            
            card.innerHTML = `
                <div class="additional-item-name">${item}</div>
                <div class="additional-note">Zusätzlicher Partybeitrag</div>
                <div class="item-counter">${currentCount} ${currentCount === 1 ? 'Person' : 'Personen'}</div>
                ${personsList ? `<div class="persons-list">${personsList}</div>` : ''}
                <div class="item-controls">
                    <input type="text" class="name-input" placeholder="Dein Name" id="additional-input-${index}">
                    <button class="btn btn-take" onclick="addAdditionalPerson('${item}', ${index})">Eintragen</button>
                </div>
            `;
            
            grid.appendChild(card);
        });
    }
    
    // Neues Item hinzufügen
    function addNewItem() {
        const input = document.getElementById('newItemInput');
        const itemName = input.value.trim();
        
        if (itemName) {
            // Überprüfe ob das Item bereits existiert
            if (items.includes(itemName) || additionalItems[itemName]) {
                alert('Dieses Item existiert bereits!');
                return;
            }
            
            // Erstelle neues zusätzliches Item
            additionalItems[itemName] = [];
            
            input.value = '';
            saveData();
            createAdditionalItemCards();
            
            // Sync wenn verbunden
            if (isGoogleDriveConnected && isAdminLoggedIn) {
                setTimeout(() => syncToGoogleDrive(), 1000);
            }
        } else {
            alert('Bitte gib einen Namen für den Partybeitrag ein!');
        }
    }
    
    // Person zu zusätzlichem Item hinzufügen
    async function addAdditionalPerson(item, index) {
        const input = document.getElementById(`additional-input-${index}`);
        const name = input.value.trim();
        
        if (name) {
            // Überprüfe ob die Person bereits eingetragen ist
            const existingPersons = additionalItems[item] || [];
            const alreadyRegistered = existingPersons.some(reg => reg.person.toLowerCase() === name.toLowerCase());
            
            if (alreadyRegistered) {
                alert('Diese Person ist bereits für dieses Item eingetragen!');
                input.value = '';
                return;
            }
            
            const cardElement = document.getElementById(`additional-card-${index}`);
            showThankYouEffect(cardElement);
            
            setTimeout(() => {
                if (!additionalItems[item]) {
                    additionalItems[item] = [];
                }
                
                additionalItems[item].push({
                    person: name,
                    timestamp: new Date().toLocaleString('de-DE')
                });
                
                saveData();
                createAdditionalItemCards();
                
                if (isGoogleDriveConnected && isAdminLoggedIn) {
                    setTimeout(() => syncToGoogleDrive(), 1000);
                }
            }, 1500);
            
        } else {
            alert('Bitte gib deinen Namen ein!');
        }
    }
    
    // Person von zusätzlichem Item entfernen
    async function unregisterAdditionalPerson(item, personName, index) {
        const inputName = prompt(`Bestätige deinen Namen um dich auszutragen:\n(${personName})`);
        
        if (inputName && inputName.trim().toLowerCase() === personName.toLowerCase()) {
            const cardElement = document.getElementById(`additional-card-${index}`);
            showGoodbyeEffect(cardElement);
            
            setTimeout(() => {
                if (additionalItems[item]) {
                    additionalItems[item] = additionalItems[item].filter(reg => reg.person !== personName);
                    
                    // Entferne das Item komplett wenn keine Personen mehr eingetragen sind
                    if (additionalItems[item].length === 0) {
                        delete additionalItems[item];
                    }
                }
                
                saveData();
                createAdditionalItemCards();
                
                if (isGoogleDriveConnected && isAdminLoggedIn) {
                    setTimeout(() => syncToGoogleDrive(), 1000);
                }
            }, 1500);
            
        } else if (inputName) {
            alert('Der Name stimmt nicht überein. Nur die Person, die sich eingetragen hat, kann sich wieder austragen.');
        }
    }
    
    // Person hinzufügen
    async function addPerson(item, index) {
        const input = document.getElementById(`input-${index}`);
        const name = input.value.trim();
        
        if (name) {
            // Überprüfe ob die Person bereits eingetragen ist
            const existingPersons = itemStates[item] || [];
            const alreadyRegistered = existingPersons.some(reg => reg.person.toLowerCase() === name.toLowerCase());
            
            if (alreadyRegistered) {
                alert('Diese Person ist bereits für dieses Item eingetragen!');
                input.value = '';
                return;
            }
            
            const cardElement = document.getElementById(`card-${index}`);
            showThankYouEffect(cardElement);
            
            setTimeout(() => {
                if (!itemStates[item]) {
                    itemStates[item] = [];
                }
                
                itemStates[item].push({
                    person: name,
                    timestamp: new Date().toLocaleString('de-DE')
                });
                
                saveData();
                createItemCards();
                updateProgress();
                
                if (isGoogleDriveConnected && isAdminLoggedIn) {
                    setTimeout(() => syncToGoogleDrive(), 1000);
                }
            }, 1500);
            
        } else {
            alert('Bitte gib deinen Namen ein!');
        }
    }
    
    // Person entfernen
    async function unregisterPerson(item, personName, index) {
        const inputName = prompt(`Bestätige deinen Namen um dich auszutragen:\n(${personName})`);
        
        if (inputName && inputName.trim().toLowerCase() === personName.toLowerCase()) {
            const cardElement = document.getElementById(`card-${index}`);
            showGoodbyeEffect(cardElement);
            
            setTimeout(() => {
                if (itemStates[item]) {
                    itemStates[item] = itemStates[item].filter(reg => reg.person !== personName);
                }
                
                saveData();
                createItemCards();
                updateProgress();
                
                if (isGoogleDriveConnected && isAdminLoggedIn) {
                    setTimeout(() => syncToGoogleDrive(), 1000);
                }
            }, 1500);
            
        } else if (inputName) {
            alert('Der Name stimmt nicht überein. Nur die Person, die sich eingetragen hat, kann sich wieder austragen.');
        }
    }
    
    // Export zu CSV
    function exportToCSV() {
        if (!isAdminLoggedIn) {
            alert('Zugriff verweigert!');
            return;
        }
        
        const data = createExcelData();
        const csvContent = convertToCSV(data);
        
        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        const url = URL.createObjectURL(blob);
        link.setAttribute('href', url);
        link.setAttribute('download', 'Birthday-Party-Partybeitraege.csv');
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }
    
    // Alle Daten löschen (Admin-Funktion)
    function clearAllData() {
        if (!isAdminLoggedIn) {
            alert('Zugriff verweigert!');
            return;
        }
        
        if (confirm('ACHTUNG! Alle Eintragungen werden unwiderruflich gelöscht!\n\nMöchten Sie wirklich alle Daten löschen?')) {
            if (confirm('Sind Sie sich absolut sicher? Diese Aktion kann nicht rückgängig gemacht werden!')) {
                // Lösche alle Daten
                localStorage.removeItem('birthday-party-contributions');
                localStorage.removeItem('birthday-party-items'); // alte Daten
                localStorage.removeItem('birthday-party-additional-contributions');
                localStorage.removeItem('birthday-party-additional-items'); // alte Daten
                localStorage.removeItem('google-drive-file-id');
                
                // Setze alle Variablen zurück
                items.forEach(item => {
                    itemStates[item] = [];
                });
                additionalItems = {};
                googleDriveFileId = null;
                
                // Aktualisiere die Anzeige
                createItemCards();
                createAdditionalItemCards();
                updateProgress();
                
                alert('Alle Daten wurden erfolgreich gelöscht!');
                
                // Sync wenn verbunden
                if (isGoogleDriveConnected && isAdminLoggedIn) {
                    setTimeout(() => syncToGoogleDrive(), 1000);
                }
            }
        }
    }
    
    // Export zu Excel
    function exportToExcel() {
        if (!isAdminLoggedIn) {
            alert('Zugriff verweigert!');
            return;
        }
        
        const data = createExcelData();
        
        const ws = XLSX.utils.aoa_to_sheet(data);
        
        ws['!cols'] = [
            { wch: 25 }, // Item
            { wch: 10 }, // Benötigt
            { wch: 12 }, // Eingetragen
            { wch: 20 }, // Person
            { wch: 20 }  // Timestamp
        ];
        
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, 'Partybeitraege');
        
        XLSX.writeFile(wb, 'Birthday-Party-Partybeitraege.xlsx');
    }
    
    // Enter-Taste für Admin-Login
    document.addEventListener('keypress', function(event) {
        if (event.key === 'Enter') {
            const adminPasswordField = document.getElementById('adminPassword');
            if (adminPasswordField === document.activeElement) {
                adminLogin();
            }
        }
    });
    
    // Focus-Effekte für Admin-Input
    document.addEventListener('DOMContentLoaded', function() {
        const adminInput = document.getElementById('adminPassword');
        const adminGlow = document.querySelector('.admin-input-glow');
        
        if (adminInput && adminGlow) {
            adminInput.addEventListener('focus', function() {
                adminGlow.style.opacity = '1';
            });
            
            adminInput.addEventListener('blur', function() {
                adminGlow.style.opacity = '0';
            });
        }
    });
    
    // Initialisierung
    document.addEventListener('DOMContentLoaded', function() {
        loadData();
        createStars();
        createNeonLines();
        createItemCards();
        createAdditionalItemCards();
        updateProgress();
        checkAdminStatus();
        
        // Enter-Taste für neues Item
        document.getElementById('newItemInput').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                addNewItem();
            }
        });
        
        if (CLIENT_ID !== 'YOUR_CLIENT_ID' && API_KEY !== 'YOUR_API_KEY') {
            initializeGoogleDrive();
        }
    });
</script>
```

</body>
</html>